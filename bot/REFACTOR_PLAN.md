# План рефакторинга структуры проекта

Ниже представлены шаги по полной миграции на новую архитектуру с учётом удаления старой реализации в папке `core`.

1. [x] Создать структуру `bot_worker`
   ```
   bot_worker/
   ├─ start_menu/
   │   ├─ __init__.py
   │   ├─ handlers.py
   │   └─ services.py
   ├─ products/
   │   ├─ __init__.py
   │   ├─ handlers.py
   │   └─ services.py
   ├─ cart/
   │   ├─ __init__.py
   │   ├─ handlers.py
   │   └─ services.py
   ├─ orders/
   │   ├─ __init__.py
   │   ├─ handlers.py
   │   └─ services.py
   ├─ payments/
   │   ├─ __init__.py
   │   ├─ handlers.py
   │   └─ services.py
   ├─ faq/
   │   ├─ __init__.py
   │   ├─ handlers.py
   │   └─ services.py
   ├─ broadcast/
   │   ├─ __init__.py
   │   ├─ handlers.py
   │   └─ services.py
   └─ util/
       ├─ __init__.py
       └─ helpers.py
   ```
   - цель: чёткое разделение по зонам ответственности и готовность к масштабированию

2. [ ] Перенести бизнес‑логику
   - из старых файлов вынести «что делает» в соответствующие `services.py` каждого модуля
   - цель: изоляция логики от кода регистрации роутов

3. [ ] Реализовать обработчики в `handlers.py`
   - оставить только регистрацию `Router` и вызовы функций из `services.py`
   - цель: разделение обязанностей «когда/как вызывать» и «что выполнять»

4. [ ] Перенести HTTP‑API
   - перенести код из `core/bot_api.py` в новый модуль, например `bot_worker/api/`
   - подключить маршруты в `main.py`
   - цель: единая структура для всех точек входа (Telegram + REST)

5. [ ] Обновить `main.py`
   - убрать импорты из `core`
   - импортировать и включить все `router` из `bot_worker/*/handlers.py`
   - при необходимости настроить `uvicorn` на новый `app` из `bot_worker/api`

6. [ ] Обновить окружение
   - привести в порядок `settings.py`, `requirements.txt`, `Dockerfile`
   - удалить ненужные зависимости, добавить новые при необходимости

7. [ ] Удалить папку `core`
   - удалить файлы `core/bot_main.py`, `core/bot_pay.py`, `core/bot_faq.py`, `core/bot_api.py` или всю папку целиком
   - цель: убрать устаревший код и избежать конфликтов импортов

8. [ ] Проверить код
   - прогнать линтер/flake8/mypy и исправить ошибки
   - цель: соблюдение код‑стайла и отсутствие регрессий

9. [ ] Запустить и протестировать
   - запустить Telegram-бот (polling) и HTTP‑API (uvicorn)
   - убедиться, что все функции работают корректно как до рефакторинга 